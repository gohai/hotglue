$(document).ready(function(){var a=false;$(".page_browser_entry").bind("mouseenter",function(c){if(a){$(a).remove()}var b="<span>";b+='<a href="'+$.glue.base_url+"?"+$(this).attr("id")+'/edit">edit</a> ';b+='<a href="#" class="page_browser_rename">rename</a> ';b+='<a href="#" class="page_browser_delete">delete</a> ';if($(this).attr("id")+".head"!=$.glue.conf.page.startpage){b+='<a href="#" class="page_browser_set_startpage">as startpage</a> '}b+="</span>";a=$(b);$(this).append(a)});$(".page_browser_entry").bind("mouseleave",function(b){if(a){$(a).remove();a=false}});$(".page_browser_rename").live("click",function(f){var d=$(this).parents(".page_browser_entry");var b=$(d).attr("id");var c=prompt("Change the page URL",b);if(c!=null){c=c.split(" ").join("-")}if(c!=null&&c!=b){$.glue.backend({method:"glue.rename_page",old:b,"new":c},function(e){$(d).attr("id",c);$(d).children(".page_browser_pagename").html('<a href="'+$.glue.base_url+"?"+c+'">'+c+"</a>")})}return false});$(".page_browser_delete").live("click",function(f){var d=$(this).parents(".page_browser_entry");var c=$(d).attr("id");if(confirm("Really delete page "+c+"?")){var b=[];$.glue.backend({method:"glue.revisions",pagename:c},function(h){for(var e in h){b.push(c+"."+h[e])}for(var g in b){$.glue.backend({method:"glue.delete_page",page:b[g]})}$(d).hide("fast",function(){$(this).remove()})})}return false});$(".page_browser_set_startpage").live("click",function(d){var c=$(this).parents(".page_browser_entry");var b=$(c).attr("id");$.glue.backend({method:"glue.set_startpage",page:b+".head"},function(e){$("#page_browser_startpage").remove();$(c).children(".page_browser_pagename").after(' <span id="page_browser_startpage">the start page</span>');$.glue.conf.page.startpage=b+".head";if(a){$(c).trigger("mouseenter")}})})});
